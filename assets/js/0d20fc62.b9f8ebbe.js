"use strict";(self.webpackChunktse_dev_api=self.webpackChunktse_dev_api||[]).push([[5964],{9285:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>d});var t=i(4848),o=i(8453);const a={sidebar_position:4,title:"E-Invoice management",slug:"e-invoice-management",description:"Verify, download and send your e-invoice",tags:["guides","issued document","invoice","e-invoice","sdi","xml","code example"]},s=void 0,c={id:"scenario/e-invoice-management",title:"E-Invoice management",description:"Verify, download and send your e-invoice",source:"@site/docs/scenario/e-invoice-management.md",sourceDirName:"scenario",slug:"/scenario/e-invoice-management",permalink:"/docs/scenario/e-invoice-management",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/scenario/e-invoice-management.md",tags:[{inline:!0,label:"guides",permalink:"/docs/tags/guides"},{inline:!0,label:"issued document",permalink:"/docs/tags/issued-document"},{inline:!0,label:"invoice",permalink:"/docs/tags/invoice"},{inline:!0,label:"e-invoice",permalink:"/docs/tags/e-invoice"},{inline:!0,label:"sdi",permalink:"/docs/tags/sdi"},{inline:!0,label:"xml",permalink:"/docs/tags/xml"},{inline:!0,label:"code example",permalink:"/docs/tags/code-example"}],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,title:"E-Invoice management",slug:"e-invoice-management",description:"Verify, download and send your e-invoice",tags:["guides","issued document","invoice","e-invoice","sdi","xml","code example"]},sidebar:"tutorialSidebar",previous:{title:"Invoice totals calculation",permalink:"/docs/scenario/invoice-totals"},next:{title:"E-Invoice XML customization",permalink:"/docs/scenario/e-invoice-xml-customisation"}},r={},d=[{value:"\ud83d\udd0d\xa0 Verify the E-Invoice XML",id:"mag-verify-the-e-invoice-xml",level:2},{value:"\u2b07\ufe0f\xa0 Download the E-Invoice XML",id:"arrow_down-download-the-e-invoice-xml",level:2},{value:"\ud83d\udcec\xa0 Send the E-Invoice",id:"mailbox_with_mail-send-the-e-invoice",level:2},{value:"\ud83c\udff4\u200d\u2620\ufe0f\xa0 The Dry-Run Flag",id:"pirate_flag-the-dry-run-flag",level:3},{value:"\ud83d\udea8\xa0 Get the E-Invoice rejection reason",id:"rotating_light-get-the-e-invoice-rejection-reason",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"When you need to deal with an e-invoice, we provide a handful of methods that you can use to fulfill your needs:\nyou can verify the XML of your e-invoice, download it, send it to the SDI and eventually obtain the rejection reason."}),"\n",(0,t.jsx)(n.admonition,{title:"Create your e-invoice first!",type:"info",children:(0,t.jsxs)(n.p,{children:["In this guide, we suppose you already created your e-invoice in TSE in Cloud, and you just need to send it to the SDI.\nIf this is not the case, please check ",(0,t.jsx)(n.a,{href:"/guides/invoice-creation.mdx",children:"this guide"})," to create your first invoice."]})}),"\n",(0,t.jsx)(n.admonition,{title:"I already have an e-invoice XML, can't I just send it to the SDI?",type:"danger",children:(0,t.jsxs)(n.p,{children:["Unfortunately, no. TSE in Cloud lets you send documents to the SDI only if they were created through the TSE in Cloud functionalities, so if you have an XML you can't just send it to the SDI using our APIs.\nPlease, check ",(0,t.jsx)(n.a,{href:"/guides/externally-generated-xml.md",children:"this guide"})," for a more detailed explanation."]})}),"\n",(0,t.jsxs)(n.h2,{id:"mag-verify-the-e-invoice-xml",children:["\ud83d\udd0d","\xa0 Verify the E-Invoice XML"]}),"\n",(0,t.jsxs)(n.p,{children:["With the ",(0,t.jsx)(n.a,{href:"/api-reference#get-/c/-company_id-/issued_documents/-document_id-/e_invoice/xml_verify",children:"Verify e-invoice XML"})," method, you can verify your e-invoice XML ",(0,t.jsx)(n.em,{children:"before"})," sending it to the SDI. If your XML contains an error or it is missing some fields, you can patch it by ",(0,t.jsx)(n.a,{href:"/api-reference#put-/c/-company_id-/issued_documents/-document_id-",children:"editing the invoice"}),".\nA list of the most common validation errors can be found ",(0,t.jsx)(n.a,{href:"https://help.fattureincloud.it/help/sezione/68",children:"here"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Below you can find an example of a failed XML verification:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "error": {\n    "message": "Validation XML",\n    "validation_result": [\n      "Nei dati generali del documento, il contenuto \\"0000-00-00\\" del campo Data non \xe8 nel formato valido"\n    ]\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"arrow_down-download-the-e-invoice-xml",children:["\u2b07\ufe0f","\xa0 Download the E-Invoice XML"]}),"\n",(0,t.jsxs)(n.p,{children:["With the ",(0,t.jsx)(n.a,{href:"/api-reference#get-/c/-company_id-/issued_documents/-document_id-/e_invoice/xml",children:"Get e-invoice XML"})," method you can download your e-invoice XML if you need to."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-http",children:'HTTP/1.1 200 OK\nContent-Type: text/xml;charset=UTF-8\n\n\n<p:FatturaElettronica xmlns:ds="http://www.w3.org/2000/09/xmldsig#" xmlns:p="http://ivaservizi.agenziaentrate.gov.it/docs/xsd/fatture/v1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" versione="FPR12">\n  <FatturaElettronicaHeader>\n        ...\n  </FatturaElettronicaHeader>\n  <FatturaElettronicaBody>\n        ...\n  </FatturaElettronicaBody>\n</p:FatturaElettronica>\n'})}),"\n",(0,t.jsxs)(n.h2,{id:"mailbox_with_mail-send-the-e-invoice",children:["\ud83d\udcec","\xa0 Send the E-Invoice"]}),"\n",(0,t.jsxs)(n.p,{children:["If your e-invoice XML is valid you can now send it to the SDI using the ",(0,t.jsx)(n.a,{href:"/api-reference#post-/c/-company_id-/issued_documents/-document_id-/e_invoice/send",children:"Send e-invoice"})," method."]}),"\n",(0,t.jsxs)(n.p,{children:["After the invoice has been sent, you can check its status by making a ",(0,t.jsx)(n.a,{href:"/api-reference#get-/c/-company_id-/issued_documents/-document_id-",children:"Get Issued Document"})," request: the ",(0,t.jsx)(n.strong,{children:"ei_status"})," field will contain the status of your e-invoice."]}),"\n",(0,t.jsx)(n.admonition,{title:"Check your fieldset!",type:"info",children:(0,t.jsxs)(n.p,{children:["To show the ",(0,t.jsx)(n.strong,{children:"ei_status"})," field, you need to ",(0,t.jsx)(n.a,{href:"/docs/basics/additional-capabilities/customize-response",children:"customize the response"}),", selecting the ",(0,t.jsx)(n.em,{children:"detailed"})," fieldset or including it in the fields list."]})}),"\n",(0,t.jsxs)(n.h3,{id:"pirate_flag-the-dry-run-flag",children:["\ud83c\udff4\u200d\u2620\ufe0f","\xa0 The Dry-Run Flag"]}),"\n",(0,t.jsxs)(n.p,{children:["If you are developing an integration and you want to test the ",(0,t.jsx)(n.a,{href:"/api-reference#post-/c/-company_id-/issued_documents/-document_id-/e_invoice/send",children:"Send e-invoice"})," method without actually sending the invoice to the SDI we offer a proper field for this purpose, the ",(0,t.jsx)(n.strong,{children:"options.dry_run"})," flag."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n    "data": {\n        ...\n    },\n    "options": {\n        "dry_run": true\n    }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The flag is optional, and the default is ",(0,t.jsx)(n.em,{children:"false"}),"; if you use it and you set it as ",(0,t.jsx)(n.em,{children:"true"}),", all the e-invoice checks will be run but the actual dispatch."]}),"\n",(0,t.jsxs)(n.h2,{id:"rotating_light-get-the-e-invoice-rejection-reason",children:["\ud83d\udea8","\xa0 Get the E-Invoice rejection reason"]}),"\n",(0,t.jsxs)(n.p,{children:["If your e-invoice gets rejected by the SDI, you can check the rejection reason with the ",(0,t.jsx)(n.a,{href:"/api-reference#get-/c/-company_id-/issued_documents/-document_id-/e_invoice/error_reason",children:"Get rejection reason"})," method.\nThe list of the most common rejection reasons can be found ",(0,t.jsx)(n.a,{href:"https://help.fattureincloud.it/help/articolo/291-stato-fattura-elettronica-scartata",children:"here"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"For example, you could get an error like the following one:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-json",children:'{\n  "data": {\n    "reason": "Il Codice Fiscale del cliente risulta sbagliato.",\n    "code": "0036",\n    "date": "2022-02-22"\n  }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var t=i(6540);const o={},a=t.createContext(o);function s(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);